# Variables that define the AB boot process
BOOT_DEV=1

BOOT_A_PART=5
BOOT_A_ROOT=/dev/mmcblk1p6

BOOT_B_PART=9
BOOT_B_ROOT=/dev/mmcblk1p10

BOOT_COUNT_LIMIT=5

boot_path=/
boot_ab_file=uEnvAB.txt

# Needed for android
otherargs=init=/init androidboot.selinux=permissive androidboot.hardware=zcu102 firmware_class.path=/system/etc/firmware clk_ignore_unused

# Load and run the AB script
loadABscript_addr=0x3000000
ABscript=AB.img
loadABscript=load mmc $sdbootdev:$partid ${loadABscript_addr} ${ABscript}
runABscript=run loadABscript; source ${loadABscript_addr}

# Called by the AB script
prepboot=setenv fdt_file iveia-helios-z8.dtb;run iv_helios_ivmmc;setenv sdbootdev ${iv_mmc}; run uenvboot; setenv iv_tty ttyPS0; run defargs;
defabargs=setenv abbootargs console=${iv_tty},115200n8 iv_mb=${iv_mb} iv_io=${iv_io} iv_bp=${iv_bp} iv_mmc=${iv_mmc} rw rootwait rootfstype=ext4 earlycon mem=2032M ${otherargs}
fdtcommand=echo "fdtcommand"; fdt addr $fdt_addr && fdt ivclean mb $iv_mb_ord && fdt ivclean bp $iv_bp_ord && fdt ivclean io $iv_io_ord && echo "done" 

# iVeia Boot process
setup=setenv fdt_file iveia-helios-z8.dtb;setenv iv_mmc 1; mmc dev 0;if fatload mmc 0 ${fdt_addr} ${fdt_file}; then setenv iv_mmc 0; fi; mmc dev 1; setenv sdbootdev ${iv_mmc}; setenv iv_tty ttyPS0; 
memadj=echo "mem adjust"; mw ff180080 40; mw ff180084 40; mw ff0a0244 00002003; mw ff0a0248 00002003; mw ff0a0008 20032003; mw ff0a0044 00002003;
fpga_setup=run rst_fpga_active; fatload mmc $sdbootdev ${xloadaddr} ${xloadfile}; fpga loadb 0 ${xloadaddr} ${filesize}; run rst_fpga_inactive
defargs=run setup; run memadj; run fpga_setup; setenv modeboot runABscript
